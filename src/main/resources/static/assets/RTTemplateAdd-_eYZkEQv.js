import{r as v,j as R,k as D,f as B,w as l,d as n,o as M,b as t,a as g,p as _,l as F,q as L,V as f,n as O}from"./index-DkAa4VJT.js";import{_ as P}from"./LoginOut-ChvC3TuR.js";const S={style:{"text-align":"center"}},G={__name:"RTTemplateAdd",setup(W){const C=L(),b=v(),r=v({templateName:null,application:null,flowNumber:1}),k=R({templateName:[{required:!0,message:"this field is required"}],application:[{required:!0,message:"this field is required"}],flowNumber:[{required:!0,message:"this field is required"}]}),c=v(),m=R({columns:[],data:[]}),w=()=>{const a=Number(r.value.flowNumber),e={type:"checkbox",width:60},i={field:"flowPoint",title:"End-to-end flow with LOU application",editRender:{name:"input"}};m.columns=[e,i];for(let o=1;o<=a;o++){const s={field:`RT${o}`,title:`application${o}`,editRender:{name:"input"}};m.columns[o+1]=s}},N=async()=>{const a=c.value;if(a){const e=a.getCheckboxRecords();if(e&&e.length>0)for(const i of e){let o=a.getRowSeq(i);const{row:s}=await a.insertAt({},o-1);await a.setEditCell(s,"name")}else{const{row:i}=await a.insertAt({},-1);await a.setEditCell(i,"name")}}},T=async()=>{const a=c.value;a&&await f.modal.confirm("您确定要还原数据吗?")==="confirm"&&await a.revertData()},V=async()=>{const a=c.value;a&&await f.modal.confirm("您确定删除数据吗?")==="confirm"&&await a.removeCheckboxRow()},I=async()=>{const a=b.value;if(a)if(await a.validate())f.modal.message({status:"error",content:"校验不通过！"});else{const o=c.value.getTableData();m.data=o.visibleData;let s=v(r.value);s.value.rtFlow=m.data,O.post("rt/add",s.value).then(u=>{f.modal.message({content:"保存成功",status:"success"}),x()}).catch(u=>{f.modal.message({content:u,status:"error"})})}},x=()=>{C.push({name:"home-page",query:{at:"rtTemplate"}})};return D(()=>{w()}),(a,e)=>{const i=n("vxe-layout-header"),o=n("vxe-input"),s=n("vxe-form-item"),u=n("vxe-option"),h=n("vxe-select"),E=n("vxe-number-input"),q=n("vxe-form"),d=n("vxe-button"),U=n("vxe-grid"),$=n("vxe-layout-body"),A=n("vxe-layout-container");return M(),B(A,{vertical:""},{default:l(()=>[t(i,{fixed:"",style:{"background-color":"#a6c9ed"}},{default:l(()=>[t(P)]),_:1}),t($,null,{default:l(()=>[g("div",null,[t(q,{ref_key:"formRef",ref:b,data:r.value,"title-width":"140",rules:k},{default:l(()=>[t(s,{title:"summary name",field:"templateName",span:"8","item-render":{}},{default:l(y=>[t(o,{modelValue:r.value.templateName,"onUpdate:modelValue":e[0]||(e[0]=p=>r.value.templateName=p)},null,8,["modelValue"])]),_:1}),t(s,{title:"application",field:"application",span:"8","item-render":{}},{default:l(y=>[t(h,{modelValue:r.value.application,"onUpdate:modelValue":e[1]||(e[1]=p=>r.value.application=p),placeholder:"application",size:"medium"},{default:l(()=>[t(u,{value:"IRECRUIT2.0",label:"IRECRUIT2.0"}),t(u,{value:"IRECRUIT1.0",label:"IRECRUIT1.0"}),t(u,{value:"CAT",label:"CAT"}),t(u,{value:"AI INTERVIEW",label:"AI INTERVIEW"})]),_:1},8,["modelValue"])]),_:1}),t(s,{title:"flow number",field:"flowNumber",span:"8","item-render":{}},{default:l(y=>[t(E,{modelValue:r.value.flowNumber,"onUpdate:modelValue":e[2]||(e[2]=p=>r.value.flowNumber=p),placeholder:"只能输入整数",type:"integer",min:"1",max:"8",onChange:w},null,8,["modelValue"])]),_:1})]),_:1},8,["data","rules"]),t(d,{status:"primary",onClick:N},{default:l(()=>e[3]||(e[3]=[_("新增模板数据")])),_:1}),t(d,{status:"primary",onClick:T},{default:l(()=>e[4]||(e[4]=[_("取消变更")])),_:1}),t(d,{status:"primary",onClick:V},{default:l(()=>e[5]||(e[5]=[_("删除选中")])),_:1}),t(U,F({ref_key:"tableRef",ref:c},m,{"show-overflow":"","keep-source":"","edit-config":{trigger:"click",mode:"cell",showStatus:!0},data:m.data}),null,16,["data"])]),g("p",S,[t(d,{status:"primary",content:"保存",onClick:I}),t(d,{content:"返回",onClick:x})])]),_:1})]),_:1})}}};export{G as default};
