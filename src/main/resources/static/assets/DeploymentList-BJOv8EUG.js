import{j as y,r as g,k as U,c as F,b as n,l as A,t as h,w as o,n as v,V as d,d as r,o as B,p as m,q as H}from"./index-CqrH7YVM.js";const L={__name:"DeploymentList",setup(J){const x=H(),l=y({total:0,currentPage:1,pageSize:10}),f=g(!1),k=g(),C=g(),i=async()=>{f.value=!0;const{pageSize:t,currentPage:e}=l;let p=g(R.data);p.value.pageSize=t,p.value.pageNum=e,await v.post("deployment/page",p.value).then(a=>{l.total=a.totalRecordNum,C.value=a.data}).catch(a=>{d.modal.message({content:a,status:"error"})}).finally(()=>{f.value=!1})},I=({pageSize:t,currentPage:e})=>{l.currentPage=e,l.pageSize=t,i()},b=t=>{d.modal.confirm({title:"操作提示",content:"请您确认是否删除？",onConfirm:()=>{v.delete(`deployment/delete/${t}`,{}).then(e=>{d.modal.message({content:"删除成功",status:"success"}),i()}).catch(e=>{d.modal.message({content:e,status:"error"})})}})},P=t=>{const e={deploymentId:t};x.push({name:"update-deployment",state:e})},_=t=>{v.get(`download/rt?deploymentId=${t.id}`).then(e=>{d.saveFile({filename:`RT-${t.applicationName}`,type:"xlsx",content:e})}).catch(e=>{d.modal.message({content:e,status:"error"})})},T=t=>{v.get(`download/pvt?deploymentId=${t.id}`).then(e=>{d.saveFile({filename:`[${t.applicationName}] ${t.deploymentDate.replace(/-/g,"")} Launch PVT Result v1.0`,type:"docx",content:e})}).catch(e=>{d.modal.message({content:e,status:"error"})})},N=t=>{const e={deploymentId:t.id};x.push({name:"add-ticket",state:e})},V=t=>{const e={deploymentId:t.id};x.push({name:"base-case-relate",state:e})},E=y({name:"VxeSelect",options:[{label:"--请选择--",value:null},{label:"IRECRUIT2.0",value:"IRECRUIT2.0"},{label:"IRECRUIT1.0",value:"IRECRUIT1.0"},{label:"CAT",value:"CAT"},{label:"AI INTERVIEW",value:"AI INTERVIEW"}]}),R=y({data:{deploymentDateFrom:null,deploymentDateEnd:null,applicationName:null,deploymentName:null},items:[{field:"deploymentDateFrom",title:"发布时间",span:8,itemRender:{name:"VxeDatePicker"}},{field:"deploymentDateEnd",title:"-",span:8,itemRender:{name:"VxeDatePicker"}},{field:"applicationName",title:"应用",span:8,itemRender:E},{field:"deploymentName",title:"发布名称",span:8,itemRender:{name:"VxeInput"}},{span:8,itemRender:{name:"VxeButtonGroup",options:[{type:"submit",content:"搜索",status:"primary"},{type:"reset",content:"重置"}]}}]}),D={submit(){l.currentPage=1,i()},reset(){i()}};return U(()=>{i()}),(t,e)=>{const p=r("vxe-form"),a=r("vxe-button"),$=r("vxe-toolbar"),c=r("vxe-column"),S=r("vxe-table"),z=r("vxe-pager");return B(),F("div",null,[n(p,A(R,h(D)),null,16),n($,null,{buttons:o(()=>[n(a,{status:"primary","router-link":{name:"add-deployment"}},{default:o(()=>e[2]||(e[2]=[m("新增")])),_:1})]),_:1}),n(S,{border:"",ref_key:"tableRef",ref:k,height:"550",loading:f.value,"row-config":{isCurrent:!0,isHover:!0},data:C.value},{default:o(()=>[n(c,{title:"发布时间",field:"deploymentDate"}),n(c,{title:"应用",field:"applicationName"}),n(c,{title:"发布名称",field:"deploymentName"}),n(c,{title:"action",width:"340"},{default:o(({row:s})=>[n(a,{mode:"text",status:"error",onClick:u=>b(s.id)},{default:o(()=>e[3]||(e[3]=[m("删除")])),_:2},1032,["onClick"]),n(a,{mode:"text",onClick:u=>P(s.id)},{default:o(()=>e[4]||(e[4]=[m("修改")])),_:2},1032,["onClick"]),n(a,{mode:"text",content:"ticket"},{dropdowns:o(()=>[n(a,{mode:"text",onClick:u=>N(s)},{default:o(()=>e[5]||(e[5]=[m("查看ticket")])),_:2},1032,["onClick"]),n(a,{mode:"text",onClick:u=>V(s)},{default:o(()=>e[6]||(e[6]=[m("关联common")])),_:2},1032,["onClick"])]),_:2},1024),n(a,{mode:"text",content:"导出case"},{dropdowns:o(()=>[n(a,{mode:"text",onClick:u=>_(s)},{default:o(()=>e[7]||(e[7]=[m("RT")])),_:2},1032,["onClick"]),n(a,{mode:"text",onClick:u=>T(s)},{default:o(()=>e[8]||(e[8]=[m("PVT")])),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["loading","data"]),n(z,{currentPage:l.currentPage,"onUpdate:currentPage":e[0]||(e[0]=s=>l.currentPage=s),pageSize:l.pageSize,"onUpdate:pageSize":e[1]||(e[1]=s=>l.pageSize=s),total:l.total,layouts:["Home","PrevJump","PrevPage","Number","NextPage","NextJump","End","Sizes","FullJump","Total"],onPageChange:I},null,8,["currentPage","pageSize","total"])])}}};export{L as default};
