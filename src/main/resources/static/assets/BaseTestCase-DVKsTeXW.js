import{q as h,r as g,j as x,k as R,d as i,o as T,c as L,b as t,l as B,t as I,w as u,p as f,n as _,V as m}from"./index-DkAa4VJT.js";const E={__name:"BaseTestCase",setup(U){const P=h(),v=g(!1),b=g(),n=x({total:0,currentPage:1,pageSize:5}),d=async()=>{v.value=!0;const{pageSize:o,currentPage:e}=n;let s=g({});s.value.pageSize=o,s.value.pageNum=e,s.value.description=p.data.description,s.value.env=p.data.envList.reduce((a,c)=>a+Number(c),0),s.value.device=p.data.deviceList.reduce((a,c)=>a+Number(c),0),await _.post("case/base/page",s.value).then(a=>{n.total=a.totalRecordNum,b.value=a.data}).catch(a=>{m.modal.message({content:a,status:"error"})}).finally(()=>{v.value=!1})},C=({pageSize:o,currentPage:e})=>{n.currentPage=e,n.pageSize=o,d()},z=o=>{m.modal.confirm({title:"操作提示",content:"请您确认是否删除？",onConfirm:()=>{_.delete(`case/base/delete/${o.id}`,{}).then(e=>{m.modal.message({content:"删除成功",status:"success"}),d()}).catch(e=>{m.modal.message({content:e,status:"error"})})}})},S=o=>{const e={caseId:o.id};P.push({name:"base-case-update",state:e})},p=x({data:{description:null,envList:["1","2","4","8"],deviceList:["16","32"]},items:[{field:"description",title:"description",span:8,itemRender:{name:"VxeInput"}},{field:"envList",title:"env",span:6,itemRender:{name:"VxeCheckboxGroup",options:[{label:"SIT",value:"1"},{label:"UAT",value:"2"},{label:"RT",value:"4"},{label:"PVT",value:"8"}]}},{field:"deviceList",title:"device",span:4,itemRender:{name:"VxeCheckboxGroup",options:[{label:"WEB",value:"16"},{label:"IPAD",value:"32"}]}},{span:2,itemRender:{name:"VxeButtonGroup",options:[{type:"submit",content:"搜索",status:"primary"}]}}]}),k={submit(){n.currentPage=1,d()}};return R(()=>{d()}),(o,e)=>{const s=i("vxe-form"),a=i("vxe-button"),c=i("vxe-toolbar"),l=i("vxe-column"),V=i("vxe-table"),y=i("vxe-pager");return T(),L("div",null,[t(s,B(p,I(k)),null,16),t(c,null,{buttons:u(()=>[t(a,{status:"primary","router-link":{name:"base-case-add"}},{default:u(()=>e[2]||(e[2]=[f("新增")])),_:1})]),_:1}),t(V,{border:"","column-config":{resizable:!0},height:"650",loading:v.value,"row-config":{isCurrent:!0,isHover:!0},data:b.value},{default:u(()=>[t(l,{title:"description",field:"description"}),t(l,{title:"summary",field:"summary"}),t(l,{title:"step",field:"step"}),t(l,{title:"creater",field:"createUser"}),t(l,{title:"env",field:"env"}),t(l,{title:"action",width:"120",fixed:"right"},{default:u(({row:r})=>[t(a,{mode:"text",status:"error",onClick:N=>z(r)},{default:u(()=>e[3]||(e[3]=[f("删除")])),_:2},1032,["onClick"]),t(a,{mode:"text",onClick:N=>S(r)},{default:u(()=>e[4]||(e[4]=[f("修改")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["loading","data"]),t(y,{currentPage:n.currentPage,"onUpdate:currentPage":e[0]||(e[0]=r=>n.currentPage=r),pageSize:n.pageSize,"onUpdate:pageSize":e[1]||(e[1]=r=>n.pageSize=r),"page-sizes":[5,10,20,100],total:n.total,layouts:["Home","PrevJump","PrevPage","Number","NextPage","NextJump","End","Sizes","FullJump","Total"],onPageChange:C},null,8,["currentPage","pageSize","total"])])}}};export{E as default};
