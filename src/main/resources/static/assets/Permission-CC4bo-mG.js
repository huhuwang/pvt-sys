import{r as c,k as N,d as u,o as V,c as g,b as t,w as n,p,v as R,n as x,V as i}from"./index-CqrH7YVM.js";const D={key:0},q={__name:"Permission",setup(E){const m=c(),b=c(),f=c(!1),v=async()=>{f.value=!0,await x.get("permission/list").then(e=>{b.value=e}).catch(e=>{i.modal.message({content:e,status:"error"})}).finally(()=>{f.value=!1})},C=async()=>{const e=m.value;e&&await i.modal.confirm("您确定要还原数据吗?")==="confirm"&&await e.revertData()},w=async()=>{const e=m.value;if(e){const{row:o}=await e.insertAt({},-1);await e.setEditCell(o,"name")}},y=c({permissionName:[{required:!0,message:"this field is required"}],permissionCode:[{required:!0,message:"this field is required"}]}),h=async()=>{const e=m.value;if(e)if(await e.validate())i.modal.message({status:"error",content:"校验不通过！"});else{const{insertRecords:r,updateRecords:_}=e.getRecordset(),d=r.concat(_);x.post("permission/add",d).then(a=>{i.modal.message({content:"保存成功",status:"success"}),v()}).catch(a=>{i.modal.message({content:a,status:"error"})})}},k=e=>{i.modal.confirm({title:"操作提示",content:"请您确认是否删除？",onConfirm:()=>{x.delete(`permission/delete/${e}`,{}).then(o=>{i.modal.message({content:"删除成功",status:"success"}),v()}).catch(o=>{i.modal.message({content:"删除失败",status:"error"})})}})};return N(()=>{v()}),(e,o)=>{const r=u("vxe-button"),_=u("vxe-toolbar"),d=u("vxe-input"),a=u("vxe-column"),U=u("vxe-table");return V(),g("div",null,[t(_,null,{buttons:n(()=>[t(r,{onClick:w},{default:n(()=>o[0]||(o[0]=[p("新增")])),_:1}),t(r,{onClick:h},{default:n(()=>o[1]||(o[1]=[p("保存")])),_:1}),t(r,{onClick:C},{default:n(()=>o[2]||(o[2]=[p("取消")])),_:1})]),_:1}),t(U,{border:"","show-overflow":"","keep-source":"",ref_key:"tableRef",ref:m,"max-height":"800",data:b.value,loading:f.value,"row-config":{isCurrent:!0,isHover:!0},"edit-rules":y.value,"edit-config":{trigger:"click",mode:"cell",showStatus:!0}},{default:n(()=>[t(a,{field:"permissionName",title:"权限名称",sortable:"","edit-render":{autofocus:".vxe-input--inner"},width:"150"},{edit:n(({row:s})=>[t(d,{modelValue:s.permissionName,"onUpdate:modelValue":l=>s.permissionName=l,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(a,{field:"permissionCode",title:"权限编码",sortable:"","edit-render":{autofocus:".vxe-input--inner"},width:"250"},{edit:n(({row:s})=>[t(d,{modelValue:s.permissionCode,"onUpdate:modelValue":l=>s.permissionCode=l,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(a,{field:"permissionUrl",title:"功能url",sortable:"","edit-render":{autofocus:".vxe-input--inner"}},{edit:n(({row:s})=>[t(d,{modelValue:s.permissionUrl,"onUpdate:modelValue":l=>s.permissionUrl=l,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(a,{field:"permissionDescribe",title:"权限描述",sortable:"","edit-render":{autofocus:".vxe-input--inner"}},{edit:n(({row:s})=>[t(d,{modelValue:s.permissionDescribe,"onUpdate:modelValue":l=>s.permissionDescribe=l,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(a,{field:"active",title:"操作",width:"100"},{default:n(({row:s})=>[s.id?(V(),g("div",D,[t(r,{mode:"text",status:"error",onClick:l=>k(s.id)},{default:n(()=>o[3]||(o[3]=[p("删除")])),_:2},1032,["onClick"])])):R("",!0)]),_:1})]),_:1},8,["data","loading","edit-rules"])])}}};export{q as default};
