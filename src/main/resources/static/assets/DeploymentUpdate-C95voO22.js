import{r as c,k as C,f as k,w as n,n as f,V as _,d as r,o as D,b as e,a as w,e as s,q as $}from"./index-BZWBJNRr.js";import{_ as A}from"./LoginOut-GI41O1go.js";const H={__name:"DeploymentUpdate",setup(B){const I=$(),h=history.state.deploymentId,y=c();let a=c({});const u=c(),R=c({deploymentDate:[{required:!0,message:"this field is required"}],applicationName:[{required:!0,message:"this field is required"}],deploymentName:[{required:!0,message:"this field is required"}],rtTemplateVal:[{validator(){if(!u.value)return new Error("必填")}}]}),N=async()=>{await f.get(`deployment/query/${h}`).then(l=>{a.value=l,x(),u.value=l.rtTemplate?l.rtTemplate.id:null}).catch(l=>{_.modal.message({content:l,status:"error"})})},x=async()=>{const l=a.value.applicationName;u.value=null,await f.post("rt/query/with/application",{application:[l]}).then(t=>{const d=y.value;if(d){const i=[];for(let o=0;o<t.length;o++)i.push({value:`${t[o].id}`,label:`${t[o].templateName}-(created at ${t[o].createTime})`});d.reloadData(i)}}).catch(t=>{_.modal.message({content:t,status:"error"})})},b=()=>{a.value.rtTemplate||(a.value.rtTemplate={}),a.value.rtTemplate.id=u.value,f.post("deployment/add",a.value).then(l=>{_.modal.message({content:"保存成功",status:"success"}),I.push({name:"home-page"})}).catch(l=>{_.modal.message({content:l,status:"error"})})};return C(()=>{N()}),(l,t)=>{const d=r("vxe-layout-header"),i=r("vxe-date-picker"),o=r("vxe-form-item"),p=r("vxe-option"),V=r("vxe-select"),g=r("vxe-input"),T=r("vxe-button"),q=r("vxe-form"),E=r("vxe-layout-body"),U=r("vxe-layout-container");return D(),k(U,{vertical:""},{default:n(()=>[e(d,{fixed:"",style:{"background-color":"#a6c9ed"}},{default:n(()=>[e(A)]),_:1}),e(E,null,{default:n(()=>[w("div",null,[e(q,{vertical:"",data:s(a),rules:R.value,onSubmit:b},{default:n(()=>[e(o,{title:"发布日期",field:"deploymentDate",span:"24","item-render":{}},{default:n(v=>[e(i,{modelValue:s(a).deploymentDate,"onUpdate:modelValue":t[0]||(t[0]=m=>s(a).deploymentDate=m),placeholder:"日期选择"},null,8,["modelValue"])]),_:1}),e(o,{title:"应用名称",field:"applicationName",span:"24","item-render":{}},{default:n(v=>[e(V,{modelValue:s(a).applicationName,"onUpdate:modelValue":t[1]||(t[1]=m=>s(a).applicationName=m),placeholder:"applicationName",size:"medium",onChange:x},{default:n(()=>[e(p,{value:"IRECRUIT2.0",label:"IRECRUIT2.0"}),e(p,{value:"IRECRUIT1.0",label:"IRECRUIT1.0"}),e(p,{value:"CAT",label:"CAT"}),e(p,{value:"AI INTERVIEW",label:"AI INTERVIEW"})]),_:1},8,["modelValue"])]),_:1}),e(o,{title:"发布名称",field:"deploymentName",span:"24","item-render":{}},{default:n(v=>[e(g,{modelValue:s(a).deploymentName,"onUpdate:modelValue":t[2]||(t[2]=m=>s(a).deploymentName=m)},null,8,["modelValue"])]),_:1}),e(o,{title:"RT模板",field:"rtTemplateVal",span:"24","item-render":{}},{default:n(v=>[e(V,{ref_key:"selectRef",ref:y,modelValue:u.value,"onUpdate:modelValue":t[3]||(t[3]=m=>u.value=m)},null,8,["modelValue"])]),_:1}),e(o,{align:"center",span:"24","item-render":{}},{default:n(()=>[e(T,{type:"submit",status:"primary",content:"提交"}),e(T,{content:"取消","router-link":{name:"home-page"}})]),_:1})]),_:1},8,["data","rules"])])]),_:1})]),_:1})}}};export{H as default};
