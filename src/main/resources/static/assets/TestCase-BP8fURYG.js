import{r as s,j as U,k as K,f as L,w as o,n as h,V as k,d as u,o as Q,b as t,a as m,s as P,p as r,q as X}from"./index-DkAa4VJT.js";import{_ as Y}from"./LoginOut-ChvC3TuR.js";const Z={class:"row-wrapper"},ee={class:"mybg"},te={class:"mybg"},le={class:"mybg"},ae={style:{"text-align":"center"}},oe={style:{"text-align":"center"}},se={__name:"TestCase",setup(ne){const S=X(),_=s("1"),y=s("2"),b=s("4"),x=s("8"),N=s("16"),C=s("32"),T=s(!1),w=s(),z=s(),p=U({env:Number(_.value)+Number(y.value)+Number(b.value)+Number(x.value),device:Number(N.value)+Number(C.value)}),n=U({ticketTitle:null,ticketType:null,ticketNo:null,ticketId:history.state.ticketId,deploymentId:null}),d=U({total:0,currentPage:1,pageSize:10}),R=()=>{h.get(`ticket/query/${n.ticketId}`).then(l=>{n.ticketTitle=l.ticketTitle,n.ticketType=l.ticketType,n.deploymentId=l.deploymentId,n.ticketNo=l.ticketNo,V()}).catch(l=>{k.modal.message({content:l,status:"error"})})},V=async()=>{T.value=!0;const{pageSize:l,currentPage:e}=d;let c=s({});c.value.env=p.env,c.value.device=p.device,c.value.pageSize=l,c.value.pageNum=e,c.value.ticketNo=n.ticketNo,await h.post("case/page",c.value).then(v=>{d.total=v.totalRecordNum,z.value=v.data}).catch(v=>{k.modal.message({content:v,status:"error"})}).finally(()=>{T.value=!1})},$=({pageSize:l,currentPage:e})=>{d.currentPage=e,d.pageSize=l,V()},f=()=>{p.env=Number(_.value)+Number(y.value)+Number(b.value)+Number(x.value),p.device=Number(N.value)+Number(C.value),d.currentPage=1,V()},D=()=>{const l={ticketNo:n.ticketNo,ticketId:n.ticketId,deploymentId:n.deploymentId};S.push({name:"add-case",state:l})},q=()=>{const l={deploymentId:n.deploymentId};S.push({name:"add-ticket",state:l})},A=l=>{k.modal.confirm({title:"操作提示",content:"请您确认是否删除？",onConfirm:()=>{h.delete(`result/delete/${l.resultId}`,{}).then(e=>{k.modal.message({content:"删除成功",status:"success"}),V()}).catch(e=>{k.modal.message({content:e,status:"error"})})}})},B=l=>{const e={resultId:l.resultId,env:p.env,device:p.device,ticketId:n.ticketId,deploymentId:n.deploymentId};S.push({name:"verify-result",state:e})},J=({row:l,column:e})=>{if(e.field==="result"){if(l.result==1)return{backgroundColor:"green",color:"#00ff00"};if(l.result==2)return{backgroundColor:"red",color:"#ffffff"}}},E=l=>{if(l.result==1)return"PASS";if(l.result==2)return"NO PASS"};return K(()=>{R()}),(l,e)=>{const c=u("vxe-layout-header"),v=u("vxe-col"),H=u("vxe-row"),g=u("vxe-checkbox"),I=u("vxe-button"),O=u("vxe-toolbar"),i=u("vxe-column"),j=u("vxe-table"),F=u("vxe-pager"),M=u("vxe-layout-body"),W=u("vxe-layout-container");return Q(),L(W,{vertical:""},{default:o(()=>[t(c,{fixed:"",style:{"background-color":"#a6c9ed"}},{default:o(()=>[t(Y)]),_:1}),t(M,null,{default:o(()=>[m("div",Z,[t(H,{gutter:"[100,100]"},{default:o(()=>[t(v,{span:"4"},{default:o(()=>[m("div",ee,"ticketNo: "+P(n.ticketNo),1)]),_:1}),t(v,{span:"16"},{default:o(()=>[m("div",te,"ticket标题: "+P(n.ticketTitle),1)]),_:1}),t(v,{span:"4"},{default:o(()=>[m("div",le,"ticket类别: "+P(n.ticketType),1)]),_:1})]),_:1})]),m("div",null,[m("div",ae,[t(g,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=a=>_.value=a),"checked-value":"1","unchecked-value":"0",onChange:f},{default:o(()=>e[9]||(e[9]=[r("SIT")])),_:1},8,["modelValue"]),t(g,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=a=>y.value=a),"checked-value":"2","unchecked-value":"0",onChange:f},{default:o(()=>e[10]||(e[10]=[r("UAT")])),_:1},8,["modelValue"]),t(g,{modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=a=>b.value=a),"checked-value":"4","unchecked-value":"0",onChange:f},{default:o(()=>e[11]||(e[11]=[r("RT")])),_:1},8,["modelValue"]),t(g,{modelValue:x.value,"onUpdate:modelValue":e[3]||(e[3]=a=>x.value=a),"checked-value":"8","unchecked-value":"0",onChange:f},{default:o(()=>e[12]||(e[12]=[r("PVT")])),_:1},8,["modelValue"])]),m("div",oe,[t(g,{modelValue:N.value,"onUpdate:modelValue":e[4]||(e[4]=a=>N.value=a),"checked-value":"16","unchecked-value":"0",onChange:f},{default:o(()=>e[13]||(e[13]=[r("WEB")])),_:1},8,["modelValue"]),t(g,{modelValue:C.value,"onUpdate:modelValue":e[5]||(e[5]=a=>C.value=a),"checked-value":"32","unchecked-value":"0",onChange:f},{default:o(()=>e[14]||(e[14]=[r("IPAD")])),_:1},8,["modelValue"])]),t(O,null,{buttons:o(()=>[t(I,{status:"primary",onClick:D},{default:o(()=>e[15]||(e[15]=[r("新增")])),_:1}),t(I,{onClick:e[6]||(e[6]=a=>q())},{default:o(()=>e[16]||(e[16]=[r("返回ticket")])),_:1})]),_:1}),t(j,{border:"",ref_key:"tableRef",ref:w,height:"600","column-config":{resizable:!0},"cell-style":J,loading:T.value,"row-config":{isCurrent:!0,isHover:!0},data:z.value},{default:o(()=>[t(i,{title:"description",field:"description"}),t(i,{title:"summary",field:"summary"}),t(i,{title:"step",field:"step"}),t(i,{title:"reporter",field:"createUser"}),t(i,{title:"verifier",field:"updateUser"}),t(i,{title:"result",field:"result"},{default:o(({row:a})=>[m("span",null,P(E(a)),1)]),_:1}),t(i,{title:"env",field:"env"}),t(i,{title:"device",field:"device"}),t(i,{title:"action",width:"120",fixed:"right"},{default:o(({row:a})=>[t(I,{mode:"text",status:"error",onClick:G=>A(a)},{default:o(()=>e[17]||(e[17]=[r("删除")])),_:2},1032,["onClick"]),t(I,{mode:"text",onClick:G=>B(a)},{default:o(()=>e[18]||(e[18]=[r("验证")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["loading","data"]),t(F,{currentPage:d.currentPage,"onUpdate:currentPage":e[7]||(e[7]=a=>d.currentPage=a),pageSize:d.pageSize,"onUpdate:pageSize":e[8]||(e[8]=a=>d.pageSize=a),total:d.total,layouts:["Home","PrevJump","PrevPage","Number","NextPage","NextJump","End","Sizes","FullJump","Total"],onPageChange:$},null,8,["currentPage","pageSize","total"])])]),_:1})]),_:1})}}};export{se as default};
