import{r as i,j as q,k as L,f as W,w as u,n as N,V as h,d as v,o as j,b as l,a as M,p as c,e as S,q as H}from"./index-Bcze8WgH.js";import{_ as $}from"./LoginOut-cJFqAwEf.js";const O={__name:"BaseCaseUpdate",setup(G){const B=H(),I=history.state.caseId,o=i({}),x=i("0"),R=i("0"),w=i("0"),y=i("0"),b=i("0"),V=i("0"),T=i("0"),g=i("0");let U=i(!1);const m=()=>{const d=Number(x.value),e=Number(R.value),k=Number(w.value),f=Number(y.value),n=Number(b.value),a=Number(V.value),_=Number(T.value),r=Number(g.value);n>0||a>0?U.value=!0:U.value=!1;let s=[];d>0&&s.push(d),e>0&&s.push(e),k>0&&s.push(k),f>0&&s.push(f),n>0&&s.push(n),a>0&&s.push(a),_>0&&s.push(_),r>0&&s.push(r),o.value.category=s.join()},E=async()=>{await N.get(`case/base/query/${I}`).then(d=>{o.value=d;const e=d.category.split(",");e.includes("17")&&(x.value="17"),e.includes("33")&&(R.value="33"),e.includes("18")&&(w.value="18"),e.includes("34")&&(y.value="34"),e.includes("20")&&(b.value="20"),e.includes("36")&&(V.value="36"),e.includes("24")&&(T.value="24"),e.includes("40")&&(g.value="40"),m()}).catch(d=>{h.modal.message({content:d,status:"error"})})},P=q({envList:[{validator(){if(!o.value.category)return new Error("this field is required")}}],rtFlow:[{validator(){if((Number(b.value)>0||Number(V.value)>0)&&!o.value.rtFlow)return new Error("this field is required")}}]}),z=()=>{Number(b.value)+Number(V.value)<=0&&(o.value.rtFlow=null),N.post("case/base/add",o.value).then(d=>{h.modal.message({content:"保存成功",status:"success"}),C()}).catch(d=>{h.modal.message({content:d,status:"error"})})},C=()=>{B.push({name:"home-page",query:{at:"baseCase"}})};return L(()=>{E()}),(d,e)=>{const k=v("vxe-layout-header"),f=v("vxe-textarea"),n=v("vxe-form-item"),a=v("vxe-option"),_=v("vxe-select"),r=v("vxe-checkbox"),s=v("vxe-button"),A=v("vxe-form"),D=v("vxe-layout-body"),F=v("vxe-layout-container");return j(),W(F,{vertical:""},{default:u(()=>[l(k,{fixed:"",style:{"background-color":"#a6c9ed"}},{default:u(()=>[l($)]),_:1}),l(D,null,{default:u(()=>[M("div",null,[l(A,{border:"","title-background":"","vertical-align":"center","title-width":"120",data:o.value,rules:P,onSubmit:z},{default:u(()=>[l(n,{title:"description",field:"description",span:"24","item-render":{}},{default:u(t=>[l(f,{modelValue:o.value.description,"onUpdate:modelValue":e[0]||(e[0]=p=>o.value.description=p),placeholder:"case description",autosize:{minRows:2,maxRows:10}},null,8,["modelValue"])]),_:1}),l(n,{title:"summary",field:"summary",span:"24","item-render":{}},{default:u(()=>[l(f,{modelValue:o.value.summary,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.summary=t),placeholder:"case summary",autosize:{minRows:2,maxRows:10}},null,8,["modelValue"])]),_:1}),l(n,{title:"expected result",field:"expectedResult",span:"24","item-render":{}},{default:u(t=>[l(f,{modelValue:o.value.expectedResult,"onUpdate:modelValue":e[2]||(e[2]=p=>o.value.expectedResult=p),placeholder:"expected result",autosize:{minRows:2,maxRows:10}},null,8,["modelValue"])]),_:1}),l(n,{title:"step",field:"step",span:"24","item-render":{}},{default:u(t=>[l(f,{modelValue:o.value.step,"onUpdate:modelValue":e[3]||(e[3]=p=>o.value.step=p),placeholder:"step",autosize:{minRows:2,maxRows:10}},null,8,["modelValue"])]),_:1}),l(n,{title:"Priority",field:"priority",span:"24","item-render":{}},{default:u(t=>[l(_,{modelValue:o.value.priority,"onUpdate:modelValue":e[4]||(e[4]=p=>o.value.priority=p),placeholder:"priority",size:"medium"},{default:u(()=>[l(a,{value:1,label:"Urgent"}),l(a,{value:2,label:"Highest"}),l(a,{value:3,label:"High"}),l(a,{value:4,label:"Low"}),l(a,{value:5,label:"Lowest"}),l(a,{value:6,label:"Blocker"}),l(a,{value:7,label:"Critical"}),l(a,{value:8,label:"Major"}),l(a,{value:9,label:"Minor"}),l(a,{value:10,label:"Trivial"})]),_:1},8,["modelValue"])]),_:1}),l(n,{title:"适用场景",field:"envList",span:"24","item-render":{}},{default:u(()=>[l(r,{modelValue:x.value,"onUpdate:modelValue":e[5]||(e[5]=t=>x.value=t),"checked-value":"17","unchecked-value":"0",onChange:m},{default:u(()=>e[14]||(e[14]=[c("SIT-WEB")])),_:1},8,["modelValue"]),l(r,{modelValue:R.value,"onUpdate:modelValue":e[6]||(e[6]=t=>R.value=t),"checked-value":"33","unchecked-value":"0",onChange:m},{default:u(()=>e[15]||(e[15]=[c("SIT-IPAD")])),_:1},8,["modelValue"]),l(r,{modelValue:w.value,"onUpdate:modelValue":e[7]||(e[7]=t=>w.value=t),"checked-value":"18","unchecked-value":"0",onChange:m},{default:u(()=>e[16]||(e[16]=[c("UAT-WEB")])),_:1},8,["modelValue"]),l(r,{modelValue:y.value,"onUpdate:modelValue":e[8]||(e[8]=t=>y.value=t),"checked-value":"34","unchecked-value":"0",onChange:m},{default:u(()=>e[17]||(e[17]=[c("UAT-IPAD")])),_:1},8,["modelValue"]),l(r,{modelValue:b.value,"onUpdate:modelValue":e[9]||(e[9]=t=>b.value=t),"checked-value":"20","unchecked-value":"0",onChange:m},{default:u(()=>e[18]||(e[18]=[c("RT-WEB")])),_:1},8,["modelValue"]),l(r,{modelValue:V.value,"onUpdate:modelValue":e[10]||(e[10]=t=>V.value=t),"checked-value":"36","unchecked-value":"0",onChange:m},{default:u(()=>e[19]||(e[19]=[c("RT-IPAD")])),_:1},8,["modelValue"]),l(r,{modelValue:T.value,"onUpdate:modelValue":e[11]||(e[11]=t=>T.value=t),"checked-value":"24","unchecked-value":"0",onChange:m},{default:u(()=>e[20]||(e[20]=[c("PVT-WEB")])),_:1},8,["modelValue"]),l(r,{modelValue:g.value,"onUpdate:modelValue":e[12]||(e[12]=t=>g.value=t),"checked-value":"40","unchecked-value":"0",onChange:m},{default:u(()=>e[21]||(e[21]=[c("PVT-IPAD")])),_:1},8,["modelValue"])]),_:1}),l(n,{title:"RT模板",field:"rtFlow",span:"24","item-render":{},visible:S(U)},{default:u(t=>[l(_,{modelValue:o.value.rtFlow,"onUpdate:modelValue":e[13]||(e[13]=p=>o.value.rtFlow=p),placeholder:"RT模板",size:"medium"},{default:u(()=>[l(a,{value:"RT1",label:"RT1"}),l(a,{value:"RT2",label:"RT2"}),l(a,{value:"RT3",label:"RT3"}),l(a,{value:"RT4",label:"RT4"}),l(a,{value:"RT5",label:"RT5"}),l(a,{value:"RT6",label:"RT6"}),l(a,{value:"RT7",label:"RT7"}),l(a,{value:"RT8",label:"RT8"})]),_:1},8,["modelValue"])]),_:1},8,["visible"]),l(n,{align:"center",span:"24","item-render":{}},{default:u(()=>[l(s,{type:"submit",status:"primary",content:"提交"}),l(s,{content:"取消",onClick:C})]),_:1})]),_:1},8,["data","rules"])])]),_:1})]),_:1})}}};export{O as default};
