import{r as m,k as R,f as $,w as l,n as v,V as c,d as r,o as B,b as e,a as C,q as I}from"./index-C0HrLBRe.js";import{_ as D}from"./LoginOut-Cgiu3BLd.js";const S={__name:"UserUpdate",setup(E){const y=I(),V=history.state.userId,f=m(),a=m({}),d=m(),g=m({account:[{required:!0,message:"this field is required"}],userName:[{required:!0,message:"this field is required"}],password:[{required:!0,message:"this field is required"}],role:[{role:!0,message:"this field is required"},{validator(){if(!a.value.role.id)return new Error("this field is required")}}]}),h=async()=>{await v.get("role/list").then(t=>{const o=f.value;if(o){const i=[];for(let s=0;s<t.length;s++)i.push({value:`${t[s].id}`,label:`${t[s].roleName}`});o.reloadData(i)}}).catch(t=>{c.modal.message({content:t,status:"error"})})},q=async()=>{await v.get(`user/query/${V}`).then(t=>{a.value=t,d.value=t.role.id}).catch(t=>{c.modal.message({content:t,status:"error"})})},b=()=>{a.value.role.id=d.value,v.post("user/add",a.value).then(t=>{c.modal.message({content:"保存成功",status:"success"}),p()}).catch(t=>{c.modal.message({content:"保存失败",status:"error"})})},p=()=>{y.push({name:"home-page",query:{at:"user"}})};return R(()=>{h(),q()}),(t,o)=>{const i=r("vxe-layout-header"),s=r("vxe-input"),u=r("vxe-form-item"),k=r("vxe-select"),x=r("vxe-button"),N=r("vxe-form"),U=r("vxe-layout-body"),w=r("vxe-layout-container");return B(),$(w,{vertical:""},{default:l(()=>[e(i,{fixed:"",style:{"background-color":"#a6c9ed"}},{default:l(()=>[e(D)]),_:1}),e(U,null,{default:l(()=>[C("div",null,[e(N,{vertical:"",data:a.value,rules:g.value,onSubmit:b},{default:l(()=>[e(u,{title:"账号",field:"account",span:"24","item-render":{}},{default:l(_=>[e(s,{modelValue:a.value.account,"onUpdate:modelValue":o[0]||(o[0]=n=>a.value.account=n)},null,8,["modelValue"])]),_:1}),e(u,{title:"用户名",field:"userName",span:"24","item-render":{}},{default:l(_=>[e(s,{modelValue:a.value.userName,"onUpdate:modelValue":o[1]||(o[1]=n=>a.value.userName=n)},null,8,["modelValue"])]),_:1}),e(u,{title:"昵称",field:"nickName",span:"24","item-render":{}},{default:l(_=>[e(s,{modelValue:a.value.nickName,"onUpdate:modelValue":o[2]||(o[2]=n=>a.value.nickName=n)},null,8,["modelValue"])]),_:1}),e(u,{title:"角色",field:"role",span:"24","item-render":{}},{default:l(_=>[e(k,{ref_key:"selectRef",ref:f,modelValue:d.value,"onUpdate:modelValue":o[3]||(o[3]=n=>d.value=n)},null,8,["modelValue"])]),_:1}),e(u,{align:"center",span:"24","item-render":{}},{default:l(()=>[e(x,{type:"submit",status:"primary",content:"提交"}),e(x,{content:"取消",onClick:p})]),_:1})]),_:1},8,["data","rules"])])]),_:1})]),_:1})}}};export{S as default};
