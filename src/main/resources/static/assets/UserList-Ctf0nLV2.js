import{q as U,j as P,r as d,k as h,d as l,o as w,c as E,b as t,l as I,t as B,w as r,p,n as v,V as u}from"./index-DkAa4VJT.js";const q={__name:"UserList",setup(H){const b=U(),a=P({total:0,currentPage:1,pageSize:10}),g=d(!1),k=d(),f=d(),i=async()=>{g.value=!0;const{pageSize:n,currentPage:e}=a;let c=d(x.data);c.value.pageSize=n,c.value.pageNum=e,await v.post("user/page",c.value).then(o=>{a.total=o.totalRecordNum,f.value=o.data}).catch(o=>{u.modal.message({content:o,status:"error"})}).finally(()=>{g.value=!1})},C=({pageSize:n,currentPage:e})=>{a.currentPage=e,a.pageSize=n,i()},N=n=>{u.modal.confirm({title:"操作提示",content:"请您确认是否删除？",onConfirm:()=>{v.delete(`user/delete/${n}`,{}).then(e=>{u.modal.message({content:"删除成功",status:"success"}),i()}).catch(e=>{u.modal.message({content:e,status:"error"})})}})},z=n=>{const e={userId:n};b.push({name:"user-update",state:e})},S=n=>{v.post(`user/reset/${n}`,{}).then(e=>{u.modal.alert({title:"重置密码成功",content:`新密码是${e}`,status:"success"})}).catch(e=>{u.modal.message({content:"重置失败",status:"error"})})},x=P({data:{account:null,userName:null},items:[{field:"account",title:"账号",span:8,itemRender:{name:"VxeInput"}},{field:"userName",title:"用户名",span:8,itemRender:{name:"VxeInput"}},{span:8,itemRender:{name:"VxeButtonGroup",options:[{type:"submit",content:"搜索",status:"primary"},{type:"reset",content:"重置"}]}}]}),y={submit(){a.currentPage=1,i()},reset(){i()}};return h(()=>{i()}),(n,e)=>{const c=l("vxe-form"),o=l("vxe-button"),V=l("vxe-toolbar"),m=l("vxe-column"),R=l("vxe-table"),$=l("vxe-pager");return w(),E("div",null,[t(c,I(x,B(y)),null,16),t(V,null,{buttons:r(()=>[t(o,{status:"primary","router-link":{name:"user-add"}},{default:r(()=>e[2]||(e[2]=[p("新增")])),_:1})]),_:1}),t(R,{border:"",ref_key:"tableRef",ref:k,height:"550",loading:g.value,"row-config":{isCurrent:!0,isHover:!0},data:f.value},{default:r(()=>[t(m,{title:"账号",field:"account"}),t(m,{title:"名字",field:"userName"}),t(m,{title:"昵称",field:"nickName"}),t(m,{title:"角色",field:"role.roleName"}),t(m,{title:"action",width:"340"},{default:r(({row:s})=>[t(o,{mode:"text",status:"error",onClick:_=>N(s.id)},{default:r(()=>e[3]||(e[3]=[p("删除")])),_:2},1032,["onClick"]),t(o,{mode:"text",onClick:_=>z(s.id)},{default:r(()=>e[4]||(e[4]=[p("修改")])),_:2},1032,["onClick"]),t(o,{mode:"text",onClick:_=>S(s.id)},{default:r(()=>e[5]||(e[5]=[p("密码重置")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["loading","data"]),t($,{currentPage:a.currentPage,"onUpdate:currentPage":e[0]||(e[0]=s=>a.currentPage=s),pageSize:a.pageSize,"onUpdate:pageSize":e[1]||(e[1]=s=>a.pageSize=s),total:a.total,layouts:["Home","PrevJump","PrevPage","Number","NextPage","NextJump","End","Sizes","FullJump","Total"],onPageChange:C},null,8,["currentPage","pageSize","total"])])}}};export{q as default};
