import{r as d,j as h,k as K,f as Q,w as o,n as U,V as k,d as u,o as X,b as t,a as c,s as _,p as i,q as Y}from"./index-C0HrLBRe.js";import{_ as Z}from"./LoginOut-Cgiu3BLd.js";const ee={class:"row-wrapper"},te={class:"mybg"},le={class:"mybg"},ae={class:"mybg"},oe={style:{"text-align":"center"}},ne={style:{"text-align":"center"}},de={__name:"TestCase",setup(ue){const S=Y(),y=d("1"),x=d("2"),b=d("4"),N=d("8"),C=d("16"),V=d("32"),T=d(!1),z=d(),w=d(),p=h({env:Number(y.value)+Number(x.value)+Number(b.value)+Number(N.value),device:Number(C.value)+Number(V.value)}),n=h({ticketTitle:null,ticketType:null,ticketNo:history.state.ticketNo,ticketId:history.state.ticketId,deploymentId:null}),r=h({total:0,currentPage:1,pageSize:10}),R=()=>{U.get(`ticket/query/${n.ticketId}`).then(l=>{n.ticketTitle=l.ticketTitle,n.ticketType=l.ticketType,n.deploymentId=l.deploymentId}).catch(l=>{k.modal.message({content:l,status:"error"})})},I=async()=>{T.value=!0;const{pageSize:l,currentPage:e}=r;let v=d({});v.value.env=p.env,v.value.device=p.device,v.value.pageSize=l,v.value.pageNum=e,v.value.ticketNo=n.ticketNo,await U.post("case/page",v.value).then(m=>{r.total=m.totalRecordNum,w.value=m.data}).catch(m=>{k.modal.message({content:m,status:"error"})}).finally(()=>{T.value=!1})},$=({pageSize:l,currentPage:e})=>{r.currentPage=e,r.pageSize=l,I()},f=()=>{p.env=Number(y.value)+Number(x.value)+Number(b.value)+Number(N.value),p.device=Number(C.value)+Number(V.value),r.currentPage=1,I()},B=()=>{const l={ticketNo:n.ticketNo,ticketId:n.ticketId,deploymentId:n.deploymentId};S.push({name:"add-case",state:l})},D=()=>{const l={deploymentId:n.deploymentId};S.push({name:"add-ticket",state:l})},q=l=>{k.modal.confirm({title:"操作提示",content:"请您确认是否删除？",onConfirm:()=>{U.delete(`result/delete/${l.resultId}`,{}).then(e=>{k.modal.message({content:"删除成功",status:"success"}),I()}).catch(e=>{k.modal.message({content:e,status:"error"})})}})},A=l=>{const e={resultId:l.resultId,env:p.env,device:p.device,ticketId:n.ticketId,deploymentId:n.deploymentId};S.push({name:"verify-result",state:e})},H=({row:l,column:e})=>{if(e.field==="result"){if(l.result==1)return{backgroundColor:"green",color:"#00ff00"};if(l.result==2)return{backgroundColor:"red",color:"#ffffff"}}},J=l=>{if(l.result==1)return"PASS";if(l.result==2)return"NO PASS"},M=l=>{switch(l.priority){case 1:return"Urgent";case 2:return"Highest";case 3:return"High";case 4:return"Low";case 5:return"Lowest";case 6:return"Blocker";case 7:return"Critical";case 8:return"Major";case 9:return"Minor";case 10:return"Trivial"}};return K(()=>{I(),R()}),(l,e)=>{const v=u("vxe-layout-header"),m=u("vxe-col"),j=u("vxe-row"),g=u("vxe-checkbox"),P=u("vxe-button"),E=u("vxe-toolbar"),s=u("vxe-column"),L=u("vxe-table"),O=u("vxe-pager"),F=u("vxe-layout-body"),W=u("vxe-layout-container");return X(),Q(W,{vertical:""},{default:o(()=>[t(v,{fixed:"",style:{"background-color":"#a6c9ed"}},{default:o(()=>[t(Z)]),_:1}),t(F,null,{default:o(()=>[c("div",ee,[t(j,{gutter:"[100,100]"},{default:o(()=>[t(m,{span:"4"},{default:o(()=>[c("div",te,"ticketNo: "+_(n.ticketNo),1)]),_:1}),t(m,{span:"16"},{default:o(()=>[c("div",le,"ticket标题: "+_(n.ticketTitle),1)]),_:1}),t(m,{span:"4"},{default:o(()=>[c("div",ae,"ticket类别: "+_(n.ticketType),1)]),_:1})]),_:1})]),c("div",null,[c("div",oe,[t(g,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=a=>y.value=a),"checked-value":"1","unchecked-value":"0",onChange:f},{default:o(()=>e[9]||(e[9]=[i("SIT")])),_:1},8,["modelValue"]),t(g,{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=a=>x.value=a),"checked-value":"2","unchecked-value":"0",onChange:f},{default:o(()=>e[10]||(e[10]=[i("UAT")])),_:1},8,["modelValue"]),t(g,{modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=a=>b.value=a),"checked-value":"4","unchecked-value":"0",onChange:f},{default:o(()=>e[11]||(e[11]=[i("RT")])),_:1},8,["modelValue"]),t(g,{modelValue:N.value,"onUpdate:modelValue":e[3]||(e[3]=a=>N.value=a),"checked-value":"8","unchecked-value":"0",onChange:f},{default:o(()=>e[12]||(e[12]=[i("PVT")])),_:1},8,["modelValue"])]),c("div",ne,[t(g,{modelValue:C.value,"onUpdate:modelValue":e[4]||(e[4]=a=>C.value=a),"checked-value":"16","unchecked-value":"0",onChange:f},{default:o(()=>e[13]||(e[13]=[i("WEB")])),_:1},8,["modelValue"]),t(g,{modelValue:V.value,"onUpdate:modelValue":e[5]||(e[5]=a=>V.value=a),"checked-value":"32","unchecked-value":"0",onChange:f},{default:o(()=>e[14]||(e[14]=[i("IPAD")])),_:1},8,["modelValue"])]),t(E,null,{buttons:o(()=>[t(P,{status:"primary",onClick:B},{default:o(()=>e[15]||(e[15]=[i("新增")])),_:1}),t(P,{onClick:e[6]||(e[6]=a=>D())},{default:o(()=>e[16]||(e[16]=[i("返回ticket")])),_:1})]),_:1}),t(L,{border:"",ref_key:"tableRef",ref:z,height:"600","column-config":{resizable:!0},"cell-style":H,loading:T.value,"row-config":{isCurrent:!0,isHover:!0},data:w.value},{default:o(()=>[t(s,{title:"description",field:"description"}),t(s,{title:"summary",field:"summary"}),t(s,{title:"expected result",field:"expectedResult"}),t(s,{title:"priority",field:"priority"},{default:o(({row:a})=>[c("span",null,_(M(a)),1)]),_:1}),t(s,{title:"reporter",field:"createUser"}),t(s,{title:"verifier",field:"updateUser"}),t(s,{title:"result",field:"result"},{default:o(({row:a})=>[c("span",null,_(J(a)),1)]),_:1}),t(s,{title:"env",field:"env"}),t(s,{title:"device",field:"device"}),t(s,{title:"action",width:"120",fixed:"right"},{default:o(({row:a})=>[t(P,{mode:"text",status:"error",onClick:G=>q(a)},{default:o(()=>e[17]||(e[17]=[i("删除")])),_:2},1032,["onClick"]),t(P,{mode:"text",onClick:G=>A(a)},{default:o(()=>e[18]||(e[18]=[i("验证")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["loading","data"]),t(O,{currentPage:r.currentPage,"onUpdate:currentPage":e[7]||(e[7]=a=>r.currentPage=a),pageSize:r.pageSize,"onUpdate:pageSize":e[8]||(e[8]=a=>r.pageSize=a),total:r.total,layouts:["Home","PrevJump","PrevPage","Number","NextPage","NextJump","End","Sizes","FullJump","Total"],onPageChange:$},null,8,["currentPage","pageSize","total"])])]),_:1})]),_:1})}}};export{de as default};
