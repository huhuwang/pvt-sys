import{r as v,j as I,k as L,f as D,w as a,n as N,V as g,d as r,o as M,b as e,a as P,p as c,e as j,q as A}from"./index-9ZKT_yQe.js";import{_ as H}from"./LoginOut-CiN-Wr7x.js";const J={__name:"BaseCaseUpdate",setup(S){const T=A(),U=history.state.caseId,o=v({}),b=v("0"),f=v("0"),d=v("0"),V=v("0"),x=v("0"),_=v("0");let y=v(!1);const m=()=>{o.value.category=Number(b.value)+Number(f.value)+Number(d.value)+Number(V.value)+Number(x.value)+Number(_.value),Number(d.value)>0?y.value=!0:y.value=!1},h=async()=>{await N.get(`case/base/query/${U}`).then(n=>{o.value=n,b.value=`${n.category&1}`,f.value=`${n.category&2}`,d.value=`${n.category&4}`,V.value=`${n.category&8}`,x.value=`${n.category&16}`,_.value=`${n.category&32}`,m()}).catch(n=>{g.modal.message({content:n,status:"error"})})},C=I({envList:[{validator(){if(Number(b.value)+Number(f.value)+Number(d.value)+Number(V.value)<=0)return new Error("this field is required")}}],device:[{validator(){if(Number(x.value)+Number(_.value)<=0)return new Error("this field is required")}}],rtFlow:[{validator(){if(Number(d.value)>0&&!o.value.rtFlow)return new Error("this field is required")}}]}),$=()=>{Number(d.value)<=0&&(o.value.rtFlow=null),N.post("case/base/add",o.value).then(n=>{g.modal.message({content:"保存成功",status:"success"}),T.push({name:"home-page",query:{at:"baseCase"}})}).catch(n=>{g.modal.message({content:"保存失败",status:"error"})})},q=()=>{T.push({name:"home-page",query:{at:"baseCase"}})};return L(()=>{h()}),(n,l)=>{const B=r("vxe-layout-header"),R=r("vxe-textarea"),s=r("vxe-form-item"),t=r("vxe-option"),w=r("vxe-select"),p=r("vxe-checkbox"),k=r("vxe-button"),F=r("vxe-form"),z=r("vxe-layout-body"),E=r("vxe-layout-container");return M(),D(E,{vertical:""},{default:a(()=>[e(B,{fixed:"",style:{"background-color":"#a6c9ed"}},{default:a(()=>[e(H)]),_:1}),e(z,null,{default:a(()=>[P("div",null,[e(F,{border:"","title-background":"","vertical-align":"center","title-width":"120",data:o.value,rules:C,onSubmit:$},{default:a(()=>[e(s,{title:"description",field:"description",span:"24","item-render":{}},{default:a(u=>[e(R,{modelValue:o.value.description,"onUpdate:modelValue":l[0]||(l[0]=i=>o.value.description=i),placeholder:"case description",autosize:{minRows:2,maxRows:10}},null,8,["modelValue"])]),_:1}),e(s,{title:"summary",field:"summary",span:"24","item-render":{}},{default:a(()=>[e(R,{modelValue:o.value.summary,"onUpdate:modelValue":l[1]||(l[1]=u=>o.value.summary=u),placeholder:"case summary",autosize:{minRows:2,maxRows:10}},null,8,["modelValue"])]),_:1}),e(s,{title:"expected result",field:"expectedResult",span:"24","item-render":{}},{default:a(u=>[e(R,{modelValue:o.value.expectedResult,"onUpdate:modelValue":l[2]||(l[2]=i=>o.value.expectedResult=i),placeholder:"expected result",autosize:{minRows:2,maxRows:10}},null,8,["modelValue"])]),_:1}),e(s,{title:"Priority",field:"priority",span:"24","item-render":{}},{default:a(u=>[e(w,{modelValue:o.value.priority,"onUpdate:modelValue":l[3]||(l[3]=i=>o.value.priority=i),placeholder:"priority",size:"medium"},{default:a(()=>[e(t,{value:1,label:"Urgent"}),e(t,{value:2,label:"Highest"}),e(t,{value:3,label:"High"}),e(t,{value:4,label:"Low"}),e(t,{value:5,label:"Lowest"}),e(t,{value:6,label:"Blocker"}),e(t,{value:7,label:"Critical"}),e(t,{value:8,label:"Major"}),e(t,{value:9,label:"Minor"}),e(t,{value:10,label:"Trivial"})]),_:1},8,["modelValue"])]),_:1}),e(s,{title:"适用场景",field:"envList",span:"24","item-render":{}},{default:a(()=>[e(p,{modelValue:b.value,"onUpdate:modelValue":l[4]||(l[4]=u=>b.value=u),"checked-value":"1","unchecked-value":"0",onChange:m},{default:a(()=>l[11]||(l[11]=[c("SIT")])),_:1},8,["modelValue"]),e(p,{modelValue:f.value,"onUpdate:modelValue":l[5]||(l[5]=u=>f.value=u),"checked-value":"2","unchecked-value":"0",onChange:m},{default:a(()=>l[12]||(l[12]=[c("UAT")])),_:1},8,["modelValue"]),e(p,{modelValue:d.value,"onUpdate:modelValue":l[6]||(l[6]=u=>d.value=u),"checked-value":"4","unchecked-value":"0",onChange:m},{default:a(()=>l[13]||(l[13]=[c("RT")])),_:1},8,["modelValue"]),e(p,{modelValue:V.value,"onUpdate:modelValue":l[7]||(l[7]=u=>V.value=u),"checked-value":"8","unchecked-value":"0",onChange:m},{default:a(()=>l[14]||(l[14]=[c("PVT")])),_:1},8,["modelValue"])]),_:1}),e(s,{title:"设备",field:"device",span:"24","item-render":{}},{default:a(()=>[e(p,{modelValue:x.value,"onUpdate:modelValue":l[8]||(l[8]=u=>x.value=u),"checked-value":"16","unchecked-value":"0",onChange:m},{default:a(()=>l[15]||(l[15]=[c("WEB")])),_:1},8,["modelValue"]),e(p,{modelValue:_.value,"onUpdate:modelValue":l[9]||(l[9]=u=>_.value=u),"checked-value":"32","unchecked-value":"0",onChange:m},{default:a(()=>l[16]||(l[16]=[c("IPAD")])),_:1},8,["modelValue"])]),_:1}),e(s,{title:"RT模板",field:"rtFlow",span:"24","item-render":{},visible:j(y)},{default:a(u=>[e(w,{modelValue:o.value.rtFlow,"onUpdate:modelValue":l[10]||(l[10]=i=>o.value.rtFlow=i),placeholder:"RT模板",size:"medium"},{default:a(()=>[e(t,{value:"RT1",label:"RT1"}),e(t,{value:"RT2",label:"RT2"}),e(t,{value:"RT3",label:"RT3"}),e(t,{value:"RT4",label:"RT4"}),e(t,{value:"RT5",label:"RT5"}),e(t,{value:"RT6",label:"RT6"}),e(t,{value:"RT7",label:"RT7"}),e(t,{value:"RT8",label:"RT8"})]),_:1},8,["modelValue"])]),_:1},8,["visible"]),e(s,{align:"center",span:"24","item-render":{}},{default:a(()=>[e(k,{type:"submit",status:"primary",content:"提交"}),e(k,{content:"取消",onClick:q})]),_:1})]),_:1},8,["data","rules"])])]),_:1})]),_:1})}}};export{J as default};
