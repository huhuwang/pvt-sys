import{q as L,r as g,j as b,k as R,d as u,o as T,c as w,b as t,l as B,t as U,w as i,p as f,a as H,s as I,n as _,V as m}from"./index-C0HrLBRe.js";const G={__name:"BaseTestCase",setup(D){const P=L(),v=g(!1),x=g(),n=b({total:0,currentPage:1,pageSize:5}),d=async()=>{v.value=!0;const{pageSize:r,currentPage:e}=n;let s=g({});s.value.pageSize=r,s.value.pageNum=e,s.value.description=p.data.description,s.value.env=p.data.envList.reduce((a,c)=>a+Number(c),0),s.value.device=p.data.deviceList.reduce((a,c)=>a+Number(c),0),await _.post("case/base/page",s.value).then(a=>{n.total=a.totalRecordNum,x.value=a.data}).catch(a=>{m.modal.message({content:a,status:"error"})}).finally(()=>{v.value=!1})},C=({pageSize:r,currentPage:e})=>{n.currentPage=e,n.pageSize=r,d()},y=r=>{m.modal.confirm({title:"操作提示",content:"请您确认是否删除？",onConfirm:()=>{_.delete(`case/base/delete/${r.id}`,{}).then(e=>{m.modal.message({content:"删除成功",status:"success"}),d()}).catch(e=>{m.modal.message({content:e,status:"error"})})}})},z=r=>{const e={caseId:r.id};P.push({name:"base-case-update",state:e})},S=r=>{switch(r.priority){case 1:return"Urgent";case 2:return"Highest";case 3:return"High";case 4:return"Low";case 5:return"Lowest";case 6:return"Blocker";case 7:return"Critical";case 8:return"Major";case 9:return"Minor";case 10:return"Trivial"}},p=b({data:{description:null,envList:["1","2","4","8"],deviceList:["16","32"]},items:[{field:"description",title:"description",span:8,itemRender:{name:"VxeInput"}},{field:"envList",title:"env",span:6,itemRender:{name:"VxeCheckboxGroup",options:[{label:"SIT",value:"1"},{label:"UAT",value:"2"},{label:"RT",value:"4"},{label:"PVT",value:"8"}]}},{field:"deviceList",title:"device",span:4,itemRender:{name:"VxeCheckboxGroup",options:[{label:"WEB",value:"16"},{label:"IPAD",value:"32"}]}},{span:2,itemRender:{name:"VxeButtonGroup",options:[{type:"submit",content:"搜索",status:"primary"}]}}]}),k={submit(){n.currentPage=1,d()}};return R(()=>{d()}),(r,e)=>{const s=u("vxe-form"),a=u("vxe-button"),c=u("vxe-toolbar"),o=u("vxe-column"),V=u("vxe-table"),h=u("vxe-pager");return T(),w("div",null,[t(s,B(p,U(k)),null,16),t(c,null,{buttons:i(()=>[t(a,{status:"primary","router-link":{name:"base-case-add"}},{default:i(()=>e[2]||(e[2]=[f("新增")])),_:1})]),_:1}),t(V,{border:"","column-config":{resizable:!0},height:"650",loading:v.value,"row-config":{isCurrent:!0,isHover:!0},data:x.value},{default:i(()=>[t(o,{title:"description",field:"description"}),t(o,{title:"summary",field:"summary"}),t(o,{title:"expected result",field:"expectedResult"}),t(o,{title:"priority",field:"priority"},{default:i(({row:l})=>[H("span",null,I(S(l)),1)]),_:1}),t(o,{title:"creater",field:"createUser"}),t(o,{title:"updater",field:"updateUser"}),t(o,{title:"env",field:"env"}),t(o,{title:"action",width:"120",fixed:"right"},{default:i(({row:l})=>[t(a,{mode:"text",status:"error",onClick:N=>y(l)},{default:i(()=>e[3]||(e[3]=[f("删除")])),_:2},1032,["onClick"]),t(a,{mode:"text",onClick:N=>z(l)},{default:i(()=>e[4]||(e[4]=[f("修改")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["loading","data"]),t(h,{currentPage:n.currentPage,"onUpdate:currentPage":e[0]||(e[0]=l=>n.currentPage=l),pageSize:n.pageSize,"onUpdate:pageSize":e[1]||(e[1]=l=>n.pageSize=l),"page-sizes":[5,10,20,100],total:n.total,layouts:["Home","PrevJump","PrevPage","Number","NextPage","NextJump","End","Sizes","FullJump","Total"],onPageChange:C},null,8,["currentPage","pageSize","total"])])}}};export{G as default};
