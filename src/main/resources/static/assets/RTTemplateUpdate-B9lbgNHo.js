import{r as v,j as R,k as M,f as L,w as l,n as g,V as d,d as n,o as O,b as a,a as C,p as _,l as P,q as S}from"./index-CqrH7YVM.js";import{_ as W}from"./LoginOut-CjEjEP2Y.js";const j={style:{"text-align":"center"}},J={__name:"RTTemplateUpdate",setup(z){const k=S(),b=v(),s=v({}),I=history.state.rtTemplateId,T=R({templateName:[{required:!0,message:"this field is required"}],application:[{required:!0,message:"this field is required"}],flowNumber:[{required:!0,message:"this field is required"}]}),p=v(),u=R({columns:[],data:[]}),w=()=>{const e=Number(s.value.flowNumber),t={type:"checkbox",width:60},i={field:"flowPoint",title:"End-to-end flow with LOU application",editRender:{name:"input"}};u.columns=[t,i];for(let o=1;o<=e;o++){const r={field:`RT${o}`,title:`application${o}`,editRender:{name:"input"}};u.columns[o+1]=r}},h=async()=>{const e=p.value;if(e){const t=e.getCheckboxRecords();if(t&&t.length>0)for(const i of t){let o=e.getRowSeq(i);const{row:r}=await e.insertAt({},o-1);await e.setEditCell(r,"name")}else{const{row:i}=await e.insertAt({},-1);await e.setEditCell(i,"name")}}},N=async()=>{const e=p.value;e&&await d.modal.confirm("您确定要还原数据吗?")==="confirm"&&await e.revertData()},V=async()=>{const e=p.value;e&&await d.modal.confirm("您确定删除数据吗?")==="confirm"&&await e.removeCheckboxRow()},E=async()=>{await g.get(`rt/query/${I}`).then(e=>{s.value=e,w(),u.data=e.rtFlow}).catch(e=>{d.modal.message({content:e,status:"error"})})},q=async()=>{const e=b.value;if(e)if(await e.validate())d.modal.message({status:"error",content:"校验不通过！"});else{const o=p.value.getTableData();u.data=o.visibleData;let r=v(s.value);r.value.rtFlow=u.data,g.post("rt/add",r.value).then(m=>{d.modal.message({content:"保存成功",status:"success"}),x()}).catch(m=>{d.modal.message({content:m,status:"error"})})}},x=()=>{k.push({name:"home-page",query:{at:"rtTemplate"}})};return M(()=>{E()}),(e,t)=>{const i=n("vxe-layout-header"),o=n("vxe-input"),r=n("vxe-form-item"),m=n("vxe-option"),$=n("vxe-select"),U=n("vxe-number-input"),D=n("vxe-form"),f=n("vxe-button"),A=n("vxe-grid"),B=n("vxe-layout-body"),F=n("vxe-layout-container");return O(),L(F,{vertical:""},{default:l(()=>[a(i,{fixed:"",style:{"background-color":"#a6c9ed"}},{default:l(()=>[a(W)]),_:1}),a(B,null,{default:l(()=>[C("div",null,[a(D,{ref_key:"formRef",ref:b,data:s.value,"title-width":"140",rules:T},{default:l(()=>[a(r,{title:"summary name",field:"templateName",span:"8","item-render":{}},{default:l(y=>[a(o,{modelValue:s.value.templateName,"onUpdate:modelValue":t[0]||(t[0]=c=>s.value.templateName=c)},null,8,["modelValue"])]),_:1}),a(r,{title:"application",field:"application",span:"8","item-render":{}},{default:l(y=>[a($,{modelValue:s.value.application,"onUpdate:modelValue":t[1]||(t[1]=c=>s.value.application=c),placeholder:"application",size:"medium"},{default:l(()=>[a(m,{value:"IRECRUIT2.0",label:"IRECRUIT2.0"}),a(m,{value:"IRECRUIT1.0",label:"IRECRUIT1.0"}),a(m,{value:"CAT",label:"CAT"}),a(m,{value:"AI INTERVIEW",label:"AI INTERVIEW"})]),_:1},8,["modelValue"])]),_:1}),a(r,{title:"flow number",field:"flowNumber",span:"8","item-render":{}},{default:l(y=>[a(U,{modelValue:s.value.flowNumber,"onUpdate:modelValue":t[2]||(t[2]=c=>s.value.flowNumber=c),placeholder:"只能输入整数",type:"integer",min:"1",max:"8",onChange:t[3]||(t[3]=c=>w())},null,8,["modelValue"])]),_:1})]),_:1},8,["data","rules"]),a(f,{status:"primary",onClick:h},{default:l(()=>t[4]||(t[4]=[_("新增模板数据")])),_:1}),a(f,{status:"primary",onClick:N},{default:l(()=>t[5]||(t[5]=[_("取消变更")])),_:1}),a(f,{status:"primary",onClick:V},{default:l(()=>t[6]||(t[6]=[_("删除选中")])),_:1}),a(A,P({ref_key:"tableRef",ref:p},u,{"show-overflow":"","keep-source":"","edit-config":{trigger:"click",mode:"cell",showStatus:!0},data:u.data}),null,16,["data"])]),C("p",j,[a(f,{status:"primary",content:"保存",onClick:q}),a(f,{content:"返回",onClick:x})])]),_:1})]),_:1})}}};export{J as default};
