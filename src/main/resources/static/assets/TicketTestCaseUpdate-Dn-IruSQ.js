import{r as d,j as K,k as O,f as Q,w as t,n as S,V as N,d as v,o as X,b as l,a as Y,p as c,e as Z,q as ee}from"./index-Bcze8WgH.js";import{_ as le}from"./LoginOut-cJFqAwEf.js";const oe={__name:"TicketTestCaseUpdate",setup(ae){const q=ee(),L=history.state.caseId,u=d({}),x=d("0"),_=d("0"),T=d("0"),R=d("0"),b=d("0"),f=d("0"),k=d("0"),w=d("0");let U=d(!1);const m=()=>{const i=Number(x.value),e=Number(_.value),y=Number(T.value),g=Number(R.value),n=Number(b.value),p=Number(f.value),o=Number(k.value),V=Number(w.value);n>0||p>0?U.value=!0:U.value=!1;let s=[];i>0&&s.push(i),e>0&&s.push(e),y>0&&s.push(y),g>0&&s.push(g),n>0&&s.push(n),p>0&&s.push(p),o>0&&s.push(o),V>0&&s.push(V),u.value.category=s},M=async()=>{await S.get(`case/query/${L}`).then(i=>{u.value=i;const e=i.category;e.includes(17)&&(x.value="17",I.value=!0),e.includes(33)&&(_.value="33",h.value=!0),e.includes(18)&&(T.value="18",P.value=!0),e.includes(34)&&(R.value="34",A.value=!0),e.includes(20)&&(b.value="20",B.value=!0,E.value=!0),e.includes(36)&&(f.value="36",B.value=!0,D.value=!0),e.includes(24)&&(k.value="24",W.value=!0),e.includes(40)&&(w.value="40",z.value=!0),m()}).catch(i=>{N.modal.message({content:i,status:"error"})})},j=K({envList:[{validator(){if(!u.value.category)return new Error("this field is required")}}],rtFlow:[{validator(){if((Number(b.value)>0||Number(f.value)>0)&&!u.value.rtFlow)return new Error("this field is required")}}]}),H=()=>{Number(b.value)+Number(f.value)<=0&&(u.value.rtFlow=null),S.post("case/add",u.value).then(i=>{N.modal.message({content:"保存成功",status:"success"}),C()}).catch(i=>{N.modal.message({content:i,status:"error"})})},C=()=>{q.push({name:"home-page",query:{at:"ticketCase"}})},I=d(!1),h=d(!1),P=d(!1),A=d(!1),E=d(!1),D=d(!1),W=d(!1),z=d(!1),B=d(!1);return O(()=>{M()}),(i,e)=>{const y=v("vxe-layout-header"),g=v("vxe-input"),n=v("vxe-form-item"),p=v("vxe-textarea"),o=v("vxe-option"),V=v("vxe-select"),s=v("vxe-checkbox"),F=v("vxe-button"),$=v("vxe-form"),G=v("vxe-layout-body"),J=v("vxe-layout-container");return X(),Q(J,{vertical:""},{default:t(()=>[l(y,{fixed:"",style:{"background-color":"#a6c9ed"}},{default:t(()=>[l(le)]),_:1}),l(G,null,{default:t(()=>[Y("div",null,[l($,{border:"","title-background":"","vertical-align":"center","title-width":"120",data:u.value,rules:j,onSubmit:H},{default:t(()=>[l(n,{title:"ticket",field:"ticketNo",span:"24","item-render":{}},{default:t(a=>[l(g,{modelValue:u.value.ticketNo,"onUpdate:modelValue":e[0]||(e[0]=r=>u.value.ticketNo=r),type:"text"},null,8,["modelValue"])]),_:1}),l(n,{title:"description",field:"description",span:"24","item-render":{}},{default:t(a=>[l(p,{modelValue:u.value.description,"onUpdate:modelValue":e[1]||(e[1]=r=>u.value.description=r),placeholder:"case description",autosize:{minRows:2,maxRows:10}},null,8,["modelValue"])]),_:1}),l(n,{title:"summary",field:"summary",span:"24","item-render":{}},{default:t(()=>[l(p,{modelValue:u.value.summary,"onUpdate:modelValue":e[2]||(e[2]=a=>u.value.summary=a),placeholder:"case summary",autosize:{minRows:2,maxRows:10}},null,8,["modelValue"])]),_:1}),l(n,{title:"expected result",field:"expectedResult",span:"24","item-render":{}},{default:t(a=>[l(p,{modelValue:u.value.expectedResult,"onUpdate:modelValue":e[3]||(e[3]=r=>u.value.expectedResult=r),placeholder:"expected result",autosize:{minRows:2,maxRows:10}},null,8,["modelValue"])]),_:1}),l(n,{title:"step",field:"step",span:"24","item-render":{}},{default:t(a=>[l(p,{modelValue:u.value.step,"onUpdate:modelValue":e[4]||(e[4]=r=>u.value.step=r),placeholder:"step",autosize:{minRows:2,maxRows:10}},null,8,["modelValue"])]),_:1}),l(n,{title:"Priority",field:"priority",span:"24","item-render":{}},{default:t(a=>[l(V,{modelValue:u.value.priority,"onUpdate:modelValue":e[5]||(e[5]=r=>u.value.priority=r),placeholder:"priority",size:"medium"},{default:t(()=>[l(o,{value:1,label:"Urgent"}),l(o,{value:2,label:"Highest"}),l(o,{value:3,label:"High"}),l(o,{value:4,label:"Low"}),l(o,{value:5,label:"Lowest"}),l(o,{value:6,label:"Blocker"}),l(o,{value:7,label:"Critical"}),l(o,{value:8,label:"Major"}),l(o,{value:9,label:"Minor"}),l(o,{value:10,label:"Trivial"})]),_:1},8,["modelValue"])]),_:1}),l(n,{title:"适用场景",field:"envList",span:"24","item-render":{}},{default:t(()=>[l(s,{modelValue:x.value,"onUpdate:modelValue":e[6]||(e[6]=a=>x.value=a),"checked-value":"17","unchecked-value":"0",onChange:m,disabled:I.value},{default:t(()=>e[15]||(e[15]=[c("SIT-WEB")])),_:1},8,["modelValue","disabled"]),l(s,{modelValue:_.value,"onUpdate:modelValue":e[7]||(e[7]=a=>_.value=a),"checked-value":"33","unchecked-value":"0",onChange:m,disabled:h.value},{default:t(()=>e[16]||(e[16]=[c("SIT-IPAD")])),_:1},8,["modelValue","disabled"]),l(s,{modelValue:T.value,"onUpdate:modelValue":e[8]||(e[8]=a=>T.value=a),"checked-value":"18","unchecked-value":"0",onChange:m,disabled:P.value},{default:t(()=>e[17]||(e[17]=[c("UAT-WEB")])),_:1},8,["modelValue","disabled"]),l(s,{modelValue:R.value,"onUpdate:modelValue":e[9]||(e[9]=a=>R.value=a),"checked-value":"34","unchecked-value":"0",onChange:m,disabled:A.value},{default:t(()=>e[18]||(e[18]=[c("UAT-IPAD")])),_:1},8,["modelValue","disabled"]),l(s,{modelValue:b.value,"onUpdate:modelValue":e[10]||(e[10]=a=>b.value=a),"checked-value":"20","unchecked-value":"0",onChange:m,disabled:E.value},{default:t(()=>e[19]||(e[19]=[c("RT-WEB")])),_:1},8,["modelValue","disabled"]),l(s,{modelValue:f.value,"onUpdate:modelValue":e[11]||(e[11]=a=>f.value=a),"checked-value":"36","unchecked-value":"0",onChange:m,disabled:D.value},{default:t(()=>e[20]||(e[20]=[c("RT-IPAD")])),_:1},8,["modelValue","disabled"]),l(s,{modelValue:k.value,"onUpdate:modelValue":e[12]||(e[12]=a=>k.value=a),"checked-value":"24","unchecked-value":"0",onChange:m,disabled:W.value},{default:t(()=>e[21]||(e[21]=[c("PVT-WEB")])),_:1},8,["modelValue","disabled"]),l(s,{modelValue:w.value,"onUpdate:modelValue":e[13]||(e[13]=a=>w.value=a),"checked-value":"40","unchecked-value":"0",onChange:m,disabled:z.value},{default:t(()=>e[22]||(e[22]=[c("PVT-IPAD")])),_:1},8,["modelValue","disabled"])]),_:1}),l(n,{title:"RT模板",field:"rtFlow",span:"24","item-render":{},visible:Z(U)},{default:t(a=>[l(V,{modelValue:u.value.rtFlow,"onUpdate:modelValue":e[14]||(e[14]=r=>u.value.rtFlow=r),placeholder:"RT模板",size:"medium",disabled:B.value},{default:t(()=>[l(o,{value:"RT1",label:"RT1"}),l(o,{value:"RT2",label:"RT2"}),l(o,{value:"RT3",label:"RT3"}),l(o,{value:"RT4",label:"RT4"}),l(o,{value:"RT5",label:"RT5"}),l(o,{value:"RT6",label:"RT6"}),l(o,{value:"RT7",label:"RT7"}),l(o,{value:"RT8",label:"RT8"})]),_:1},8,["modelValue","disabled"])]),_:1},8,["visible"]),l(n,{align:"center",span:"24","item-render":{}},{default:t(()=>[l(F,{type:"submit",status:"primary",content:"提交"}),l(F,{content:"取消",onClick:C})]),_:1})]),_:1},8,["data","rules"])])]),_:1})]),_:1})}}};export{oe as default};
